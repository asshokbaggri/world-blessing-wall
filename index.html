<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>World Blessing Wall</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#000000" />
</head>

<body>

  <!-- GOLD HALO + PARTICLES -->
  <div id="goldHalo"></div>
  <canvas id="goldParticles"></canvas>

  <!-- HEADER -->
  <header class="nav fade-section" role="banner" aria-label="Main navigation">
    <div class="brand">Asshok Baggri</div>
    <nav class="menu" aria-label="Site sections">
      <a href="#myBlessings">My Blessings</a>
      <a href="#live">Live</a>
      <a href="#share">Share</a>
      <a href="#founder">Founder</a>
      <a href="#map">Map</a>
    </nav>
  </header>

  <!-- HERO -->
  <section class="hero fade-section" id="hero">
    <h1 class="title">
      Ek Dua Likho, <span class="gold">Duniya Badlo</span> <span class="sparkle">ğŸ’«</span>
    </h1>

    <p class="subtitle">
      Har dua ek vibration hoti haiâ€¦ aur vibrations hi duniya badalti hain.
    </p>

    <div class="composer fade-up">
      <label class="lbl" for="blessingInput">Your Blessing</label>

      <textarea id="blessingInput" rows="4" placeholder="Duniya ke liye ek dua likhoâ€¦"></textarea>

      <div class="row">
        <input id="countryInput" type="text" value="IN India" aria-label="Country" />
        <button id="sendBtn" class="btn-primary" type="button">Blessing Add Karo âœ¨</button>
      </div>

      <div id="status" class="status" aria-live="polite"></div>

      <div class="kpi">
        <span class="dot"></span>
        <span>Total Blessings: <strong id="counter">0</strong></span>
      </div>
    </div>

    <!-- burst container -->
    <div id="sparkleBurst" aria-hidden="true"></div>

    <!-- tiny toast popup -->
    <div id="liveToast" role="status" aria-live="polite" class="live-toast" hidden>
      <span id="liveToastText">âœ¨ Your blessing is live!</span>
    </div>

  </section>

  <!-- ğŸŒŸ STREAK SECTION (User Progress) -->
  <section id="streakSection" class="fade-section">
    <div class="container">
      <div class="streak-box">
        <div class="streak-title">Your Streak ğŸ”¥</div>

        <div class="streak-numbers">
          <div class="streak-item">
            <span class="label">Current</span>
            <span id="streakCurrent" class="value">0</span>
          </div>

          <div class="divider"></div>

          <div class="streak-item">
            <span class="label">Best</span>
            <span id="streakBest" class="value">0</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="container">
    <div id="challengeBox" class="challenge-box fade-section">
      âœ¨ Todayâ€™s Challenge: <span id="challengeText">Loading...</span>
    </div>
  </div>

  <!-- MY BLESSINGS (new) -->
  <section id="myBlessings" class="feed fade-section" aria-label="My blessings">

      <h2 class="section-title">My Blessings</h2>

      <div id="myCountBox" class="my-count-box">
          <span>Youâ€™ve written </span><strong id="myCount">0</strong><span> blessings âœ¨</span>
      </div>

      <div class="my-controls" style="display:flex;gap:12px;align-items:center;margin-bottom:14px;">
          <button id="refreshMy" class="btn" type="button">Refresh</button>
          <button id="toggleMy" class="btn" type="button">Hide My Blessings</button>
          <div id="myEmpty" style="color:var(--text-dim); margin-left:auto;">loadingâ€¦</div>
      </div>

      <div id="myBlessingsList" class="cards" role="list" aria-live="polite"></div>
      <div id="myBlessingsCount" class="status" style="margin-top:12px; text-align:center;"></div>

  </section>

  <!-- SHARE -->
  <section id="share" class="share fade-section">
    <h3>Aapki dua roshni ban kar duniya tak pahunchti hai ğŸ¤</h3>
    <div class="share-row">
      <button class="btn" id="waShare" type="button">WhatsApp</button>
      <button class="btn" id="twShare" type="button">Twitter/X</button>
      <button class="btn" id="copyShare" type="button">Copy Link</button>
    </div>
  </section>

  <!-- Auto Share Message -->
  <div id="autoShareMsg" style="display:none;">
    Aapki blessing duniya tak pahunch chuki hai âœ¨  
    Share kare aur kisi ko inspire kare â¤ï¸  
    https://asshokbaggri.github.io
  </div>

  <!-- LIVE FEED -->
  <section id="live" class="feed fade-section" aria-label="Live blessings">
    <h2 class="section-title">Live Blessings <span class="sparkle">ğŸ’«</span></h2>
    <div id="blessingsList" class="cards" role="list"></div>
    <button id="loadMore" class="load-btn" type="button">Load more</button>
    <div id="noMore" class="no-more" aria-live="polite"></div>
  </section>

  <!-- FOUNDER -->
  <section id="founder" class="founder fade-section">
    <div class="avatar">AB</div>
    <div>
      <h4>Asshok Baggri</h4>
      <div class="role">Consciousness & Peace Architect</div>
      <blockquote>
        â€œMain chahta hoon har insaan ek dua likhe, kyunki blessings hi duniya ki asli currency hain.â€
      </blockquote>
    </div>
  </section>

  <!-- ===== WORLD MAP â€” D3 (REPLACEMENT) ===== -->
  <section id="worldMapSection" class="feed fade-section" aria-label="World map">
    <h2 class="section-title">ğŸŒ Blessings Around The World</h2>
    <p class="muted" style="text-align:center;margin-top:-6px;">Tap a dot to see blessings</p>

    <div id="mapWrap" class="map-wrap" style="position:relative; margin:18px auto;">

      <canvas id="mapStarsCanvas"></canvas>
      <canvas id="mapConstellationCanvas"></canvas>
      <!-- svg container: D3 injects SVG here and JS will set its pixel height -->
      <div id="svgContainer" class="svg-container"></div>

      <!-- HTML dot layer (absolute overlay) -->
      <div id="dotLayer" class="dot-layer"></div>

      <!-- Global count -->
      <div id="globalCount" class="global-count" style="position:absolute; right:18px; top:14px; z-index:9999; background: rgba(0,0,0,0.32); color:#ffe8b3; padding:8px 12px; border-radius:999px; border:1px solid rgba(255,255,255,0.06); font-weight:700;">
        Global Blessings: <span id="globalCountNum">0</span>
      </div>

      <!-- Country drawer -->
      <aside id="countryDrawer" class="country-drawer" aria-hidden="true" style="position:fixed; right:24px; bottom:24px; width:min(520px,90vw); max-height:70vh; display:none; z-index:10000;">
        <button id="drawerClose" class="drawer-close" style="position:absolute; right:10px; top:8px; font-size:18px; background:transparent; border:none; color:var(--text-dim);">âœ•</button>
        <h3 id="drawerTitle">Country â€” 0</h3>
        <div id="drawerList" class="drawer-list" style="overflow:auto; padding-top:6px;"></div>
      </aside>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="footer fade-section">
    <div class="links">
      <a href="#">About</a>
      <a href="#">Roadmap</a>
      <a href="#">Contact</a>
    </div>
    <div class="copy">
      Â© 2025 Asshok Baggri â€” Light For Humanity ğŸŒâœ¨
    </div>
  </footer>


  <!-- USERNAME POPUP (one-time + optional) - REPLACE existing block -->
  <div id="usernamePopup" class="username-popup" hidden aria-hidden="true">
    <div class="popup-backdrop" data-role="backdrop"></div>

    <div class="popup-box" role="dialog" aria-modal="true" aria-labelledby="popupTitle">
      <h3 id="popupTitle">âœ¨ Naam Drop Karo</h3>
      <p class="muted">Aapka naam har blessing ke saath chalega â€” log dekhenge kisne duniya mein light bheji ğŸ”¥âœ¨</p>

      <label for="usernameInput" class="sr-only">Display name</label>
      <input type="text" id="usernameInput" placeholder="Aapka display naam (e.g. Ashhok)" aria-label="Enter display name" autocomplete="name" />

      <div id="usernameError" class="username-error" aria-live="polite" hidden>Naam thoda chhota lag raha hai â€” ek acha sa display name daalo âœ¨</div>

      <div class="popup-actions">
        <button id="saveUsername" class="btn-primary">Save &amp; Shine âœ¨</button>
        <button id="skipUsername" class="btn">Skip</button>
      </div>

      <div class="popup-footer muted" style="margin-top:10px; font-size:13px;">
        Naam safe local device par save rahega â€” aap kabhi bhi badal sakte ho.
      </div>
    </div>
  </div>
  
  <noscript style="color:white; display:block; text-align:center; padding:12px;">
    Please enable JavaScript to use the World Blessing Wall.
  </noscript>

  <!-- CUSTOM ALERT (iOS-style) -->
  <div id="glassAlert" class="glass-alert" hidden>
      <div class="glass-alert-inner">
      <p id="glassAlertText"></p>
      <button id="glassAlertOk" class="glass-alert-ok">OK</button>
    </div>
  </div>

  <!-- D3 Library -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

  <script>
    window.AI_ENGINE_URL = "https://your-domain.com/ai-engine"; 
    // For local development: "http://localhost:3000"
  </script>
  <!-- APP -->
  <script type="module" src="app.js"></script>
</body>
</html>
